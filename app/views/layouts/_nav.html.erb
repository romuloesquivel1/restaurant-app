<header>
  <nav class='max-w-screen-xl flex items-center justify-between mx-auto py-3 px-8 lg:px-20 sm:flex-row flex-col gap-4'>
    <%= link_to 'Restaurant App', '/', class: 'text-2xl font-semibold whitespace-nowrap' %>

    <ul class='font-semibold flex items-center gap-3'>
    
      <% if user_signed_in? %>
        <li class="p-4 lg:px-8 relative flex items-center space-x-1"
          x-data="{ open: false }"
          @mouseenter="open = true"
          @mouseleave="open = false">
          <%= link_to profile_users_path, class: 'text-slate-800 hover:text-slate-900', 'aria-expanded' => 'open' do %> 
            Welcome <%= current_user.full_name %>
          <% end %>
          <button class="shrink-0 p-1"
            :aria-expanded="open"
            @click.prevent="open = !open">
            <span class="sr-only">Show submenu for "Flyout Menu"</span>
            <svg class="w-3 h-3 fill-slate-500" xmlns="http://www.w3.org/2000/svg" width="12" height="12">
              <path d="M10 2.586 11.414 4 6 9.414.586 4 2 2.586l4 4z" />
            </svg>
          </button>
          <!-- 2nd level menu -->
          <ul
            class="origin-top-right absolute top-full left-1/2 -translate-x-1/2 min-w-[240px] bg-white border border-slate-200 p-2 rounded-lg shadow-xl [&[x-cloak]]:hidden"
            x-show="open"
            x-transition:enter="transition ease-out duration-200 transform"
            x-transition:enter-start="opacity-0 -translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            x-transition:leave="transition ease-out duration-200"
            x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0"
            x-cloak
            @focusout="await $nextTick();!$el.contains($focus.focused()) && (open = false)">
            <li>
              <%= link_to profile_users_path, class: 'text-slate-800 hover:bg-slate-50 flex items-center p-2' do %>
                <div class="flex items-center justify-center bg-white border border-slate-200 rounded shadow-sm h-7 w-7 shrink-0 mr-3">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                </div>
                <span class="whitespace-nowrap">Profile</span>
              <% end %>
            </li>
            <li>
              <%= link_to destroy_user_session_path, method: :delete, class: 'text-slate-800 hover:bg-slate-50 flex items-center p-2' do %>
                <div class="flex items-center justify-center bg-white border border-slate-200 rounded shadow-sm h-7 w-7 shrink-0 mr-3">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" />
                  </svg>
                </div>
                <span class="whitespace-nowrap">Logout</span>
              <% end %>
            </li>
          </ul>
        </li>
        
        <li class='px-4 hover:bg-slate-200 dark:hover:bg-slate-900 py-2 rounded-md transition'>
          <%= link_to 'Logout', destroy_user_session_path %>
        </li>
      <% else %>
        <li class='px-4 hover:bg-slate-200 dark:hover:bg-slate-900 py-2 rounded-md transition'>
          <%= link_to 'Login', new_user_session_path %>
        </li>
      <% end %>

    </ul>
  </nav>
</header>
